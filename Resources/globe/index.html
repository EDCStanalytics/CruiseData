<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Globe Test</title>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
    <script src="https://unpkg.com/d3-geo-projection@4"></script>
    <link rel="stylesheet" href="globe.css">
    <script src="globe.js" defer></script>
    <script  src="../JavaScripts/helpers.js" defer></script>
    <script  src="../JavaScripts/callData.js" defer></script>
    <script  src="../JavaScripts/powerData.js" defer></script>

    <script  src="../JavaScripts/header.js" defer></script>

    
    <script  src="../JavaScripts/chartEmbed.js" defer></script>
    <script src="../JavaScripts/focus.js" defer></script>
    
<!-- This installs Font Awesome-->
        <script src="https://kit.fontawesome.com/14dbedf33a.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
</head>







<header class="hBar" id="theHeaderBar">
  <h1>Elza's Data Portal</h1>

  <nav>
    <ul id="navBarItems">
      <li>Summary</li>
      <li>Vessels</li>
      <li>Services</li>
    </ul>
  </nav>

  <!-- Help icon -->
  <i class="fa-regular fa-circle-question" title="Help"></i>

  <!-- Export icon (make it a real clickable anchor with the ID your script uses) -->
  
    <i id ="download-combo"  class="fa-solid fa-database" style="cursor:pointer;" title="Download Combined Excel"></i>
  </a>
</header>

<!-- Wire up the click AFTER the element exists -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const trigger = document.getElementById('download-combo');
    if (!trigger) {
      console.error('download-combo link not found');
      return;
    }
    trigger.addEventListener('click', async (e) => {
      e.preventDefault();
      try {
        const count = await CruiseExporter.download();
        console.log('Download started. Rows:', count);
      } catch (err) {
        console.error('Export failed:', err);
        alert('Export failed: ' + err.message);
      }
    });
  });
</script>

<!-- âœ… Scripts go OUTSIDE the header and load in correct order -->

<script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js" ></script>
<script src="../JavaScripts/export.js" defer></script>
<!-- Font Awesome 6 CSS (for fa-solid / fa-regular icons). Put this in <head> ideally. -->
<link rel="stylesheet" ></link>

</header>



  <body>
    <div id="earth"></div>
  
    <div id="dataSpace">
      <div id="berthSpace"></div>

      <div id="cardSpace"></div>

      <div id="D3andME">

        <div class="kpiBucket" id="leftChartContainer">
          
          <div class="baseStats">
            <div class='speedRead' id="shipCallCounter">100</div>
            <div class='baseLabel' id="shipCallLabel">Ship Calls</div>
            <div class='baseTrend' id="shipCallPerc">10%</div>
          </div>
          
          <div id="leftRadialChart" class="radial_anchor"></div>
          <div id="leftCentralChart"></div>
          <div class="glass" aria-hidden="true"></div>

        </div>
        
        <div class="kpiBucket" id="rightChartContainer">
          
          <div class="baseStats">
            <div class='speedRead' id="shipConnectionCounter">100</div>
            <div class='baseLabel' id="shipConnectionLabel">Shore Power Connections</div>
            <div class='baseTrend' id="shipConnectionPerc">10%</div>
          </div>
        
          <div id="rightRadialChart" class="radial_anchor"></div>
          <div id="rightCentralChart"></div>
          <div class="glass" aria-hidden="true"></div>

        </div>
      </div>
    </div>
  </body>

</html>
